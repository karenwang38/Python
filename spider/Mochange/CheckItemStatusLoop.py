from MoChange import *
import time

num_list = ['200044', '744', '509', '527']
num_list = ['200106', '200104', '200102', '200100', '200098', '200096', '200094', '200092', '200090', '200088', '200086', '200084', '200082', '200080', '200078', '200076', '200075', '200074', '200072', '200070', '200068', '200066', '200063', '200060', '200058', '200057', '200056', '200055', '200054', '200053', '200051', '200049', '200047', '200045', '200044', '200043', '200042', '200039', '200025', '200024', '200023', '200021', '200020', '200017', '200015', '200012', '200007', '200005', '200002', '824', '823', '821', '820', '816', '815', '813', '812', '810', '808', '806', '804', '803', '801', '800', '795', '794', '792', '791', '789', '788', '786', '784', '764', '759', '758', '756', '755', '753', '752', '750', '749', '747', '746', '744', '743', '737', '736', '729', '720', '717', '715', '713', '709', '683', '653', '651', '649', '628', '626', '624', '620', '616', '597', '593', '561', '560', '558', '543', '542', '541', '539', '538', '536', '535', '534', '533', '531', '530', '529', '527', '522', '517', '516', '514', '512', '509', '507', '505', '501', '500', '499', '498', '497', '493', '489', '488', '383', '382', '364']

start_time = time.time()
time_period = 4 # min
time1159 = 1567310280 # 2019/09/1 11:58:0
stop_flag = False

while True:
    if (round(time.time()) > time1159) & (stop_flag == False):
        start_time = time.time()
        stop_flag = True
        while True:
            end_time = time.time()
            print('start_time: ', start_time)
            print('end_time: ', end_time)
            print('start - end: ', end_time - start_time)
            print('============================')
            print(num_list)
            if (end_time - start_time) <= (time_period*60):
                print('商品狀態檢查...')
                if len(num_list) == 0:
                    break
                for num in num_list:
                    status = CheckItemStatus(num)
                    fp=open(num, 'a')
                    fp.write(status + '\n')
                    fp.close()
                    print(status)
                    if status == '直接購買':
                        num_list.remove(num)
            else:
                print('停止檢查。')
                break
    elif stop_flag:
        break
    else:
        print('時間還沒到')
        time.sleep(60)
